server {
        listen 0.0.0.0:8443 ssl http2 so_keepalive=on;

        root /var/www/html;
        index index.html index.htm index.nginx-debian.html;

        server_name {{ dns_name }};
        ssl_certificate     /etc/letsencrypt/live/{{ dns_name }}/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/{{ dns_name }}/privkey.pem;
        ssl_protocols       TLSv1.2 TLSv1.3;
        ssl_ciphers         HIGH:!aNULL:!MD5;
	location / {
                auth_basic "Administratorâ€™s Area";
                auth_basic_user_file /etc/htpasswd;
        }
        location /{{ location }} {
		if ($content_type !~ "application/grpc") {
			return 404;
		}
		client_max_body_size 0;
		client_body_buffer_size 512k;
		grpc_set_header X-Real-IP $remote_addr;
		client_body_timeout 52w;
		grpc_read_timeout 52w;
		grpc_pass grpc://127.0.0.1:8888;
	}
}
